{% extends "layout.html" %}
{% block title %}Perfil do Usuário{% endblock %}
{% block content %}
<h2 class="mb-4"><i class="fa fa-user"></i> Perfil do Usuário</h2>
<div class="card">
    <div class="card-body">
        <h5 class="card-title">{{ usuario.nome }}</h5>
        <p class="card-text"><strong>Tipo:</strong> {{ usuario.tipo }}</p>
        <p class="card-text"><strong>Status:</strong> {% if usuario.aprovado %}<span class="badge bg-success">Aprovado</span>{% else %}<span class="badge bg-warning">Pendente</span>{% endif %}</p>
        <form method="post" action="{{ url_for('alterar_senha') }}" data-loading data-loading-text="Alterando senha...">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <div class="mb-3">
                <label for="senha_atual" class="form-label">Senha atual</label>
                <input type="password" class="form-control {% if validation_errors and 'senha_atual' in validation_errors %}is-invalid{% endif %}" 
                       id="senha_atual" name="senha_atual" required>
                {% if validation_errors and 'senha_atual' in validation_errors %}
                    <div class="invalid-feedback">
                        {% for error in validation_errors['senha_atual'] %}
                            {{ error }}{% if not loop.last %}<br>{% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
            <div class="mb-3">
                <label for="nova_senha" class="form-label">Nova senha</label>
                <input type="password" class="form-control {% if validation_errors and 'nova_senha' in validation_errors %}is-invalid{% endif %}" 
                       id="nova_senha" name="nova_senha" required>
                {% if validation_errors and 'nova_senha' in validation_errors %}
                    <div class="invalid-feedback">
                        {% for error in validation_errors['nova_senha'] %}
                            {{ error }}{% if not loop.last %}<br>{% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
                <div class="form-text">
                    Mínimo 6 caracteres, incluindo pelo menos uma letra e um número
                </div>
            </div>
            <div class="mb-3">
                <label for="confirmar_senha" class="form-label">Confirmar nova senha</label>
                <input type="password" class="form-control {% if validation_errors and 'confirmar_senha' in validation_errors %}is-invalid{% endif %}" 
                       id="confirmar_senha" name="confirmar_senha" required>
                {% if validation_errors and 'confirmar_senha' in validation_errors %}
                    <div class="invalid-feedback">
                        {% for error in validation_errors['confirmar_senha'] %}
                            {{ error }}{% if not loop.last %}<br>{% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
            <button type="submit" class="btn btn-primary"><i class="fa fa-key"></i> Alterar Senha</button>
        </form>
    </div>
</div>
{% endblock %}
